(self["webpackChunk"]=self["webpackChunk"]||[]).push([[5186],{25186:(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__(40347)["default"]},8099:(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=addWsMethod;var _wrapMiddleware=__webpack_require__(57040);var _wrapMiddleware2=_interopRequireDefault(_wrapMiddleware);var _websocketUrl=__webpack_require__(32067);var _websocketUrl2=_interopRequireDefault(_websocketUrl);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}else{return Array.from(arr)}}function addWsMethod(target){if(target.ws===null||target.ws===undefined){target.ws=function addWsRoute(route){for(var _len=arguments.length,middlewares=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){middlewares[_key-1]=arguments[_key]}var wrappedMiddlewares=middlewares.map(_wrapMiddleware2.default);var wsRoute=(0,_websocketUrl2.default)(route);this.get.apply(this,_toConsumableArray([wsRoute].concat(wrappedMiddlewares)));return this}}}},40347:(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";var __webpack_unused_export__;__webpack_unused_export__={value:true};exports["default"]=expressWs;var _http=__webpack_require__(68975);var _http2=_interopRequireDefault(_http);var _express=__webpack_require__(804);var _express2=_interopRequireDefault(_express);var _ws=__webpack_require__(53531);var _ws2=_interopRequireDefault(_ws);var _websocketUrl=__webpack_require__(32067);var _websocketUrl2=_interopRequireDefault(_websocketUrl);var _addWsMethod=__webpack_require__(8099);var _addWsMethod2=_interopRequireDefault(_addWsMethod);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function expressWs(app,httpServer){var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var server=httpServer;if(server===null||server===undefined){server=_http2.default.createServer(app);app.listen=function serverListen(){var _server;return(_server=server).listen.apply(_server,arguments)}}(0,_addWsMethod2.default)(app);if(!options.leaveRouterUntouched){(0,_addWsMethod2.default)(_express2.default.Router)}var wsOptions=options.wsOptions||{};wsOptions.server=server;var wsServer=new _ws2.default.Server(wsOptions);wsServer.on("connection",(function(socket,request){if("upgradeReq"in socket){request=socket.upgradeReq}request.ws=socket;request.wsHandled=false;request.url=(0,_websocketUrl2.default)(request.url);var dummyResponse=new _http2.default.ServerResponse(request);dummyResponse.writeHead=function writeHead(statusCode){if(statusCode>200){dummyResponse._header="";socket.close()}};app.handle(request,dummyResponse,(function(){if(!request.wsHandled){socket.close()}}))}));return{app,getWss:function getWss(){return wsServer},applyTo:function applyTo(router){(0,_addWsMethod2.default)(router)}}}},46577:(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=addTrailingSlash;function addTrailingSlash(string){var suffixed=string;if(suffixed.charAt(suffixed.length-1)!=="/"){suffixed=suffixed+"/"}return suffixed}},32067:(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"])_i["return"]()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();exports["default"]=websocketUrl;var _trailingSlash=__webpack_require__(46577);var _trailingSlash2=_interopRequireDefault(_trailingSlash);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function websocketUrl(url){if(url.indexOf("?")!==-1){var _url$split=url.split("?"),_url$split2=_slicedToArray(_url$split,2),baseUrl=_url$split2[0],query=_url$split2[1];return(0,_trailingSlash2.default)(baseUrl)+".websocket?"+query}return(0,_trailingSlash2.default)(url)+".websocket"}},57040:(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=wrapMiddleware;function wrapMiddleware(middleware){return function(req,res,next){if(req.ws!==null&&req.ws!==undefined){req.wsHandled=true;try{middleware(req.ws,req,next)}catch(err){next(err)}}else{next()}}}},53531:module=>{"use strict";module.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native "+"WebSocket object")}}}]);
//# sourceMappingURL=5186.0.52.0.1722255362764.js.map