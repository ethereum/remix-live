{"version":3,"file":"5186.0.52.0.1722255362764.js","mappings":"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","sources":["webpack:///../../node_modules/express-ws/index.js","webpack:///../../node_modules/express-ws/lib/add-ws-method.js","webpack:///../../node_modules/express-ws/lib/index.js","webpack:///../../node_modules/express-ws/lib/trailing-slash.js","webpack:///../../node_modules/express-ws/lib/websocket-url.js","webpack:///../../node_modules/express-ws/lib/wrap-middleware.js","webpack:///../../node_modules/ws/browser.js"],"sourcesContent":["module.exports = require(\"./lib\").default;\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = addWsMethod;\n\nvar _wrapMiddleware = require('./wrap-middleware');\n\nvar _wrapMiddleware2 = _interopRequireDefault(_wrapMiddleware);\n\nvar _websocketUrl = require('./websocket-url');\n\nvar _websocketUrl2 = _interopRequireDefault(_websocketUrl);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction addWsMethod(target) {\n  /* This prevents conflict with other things setting `.ws`. */\n  if (target.ws === null || target.ws === undefined) {\n    target.ws = function addWsRoute(route) {\n      for (var _len = arguments.length, middlewares = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        middlewares[_key - 1] = arguments[_key];\n      }\n\n      var wrappedMiddlewares = middlewares.map(_wrapMiddleware2.default);\n\n      /* We append `/.websocket` to the route path here. Why? To prevent conflicts when\n       * a non-WebSocket request is made to the same GET route - after all, we are only\n       * interested in handling WebSocket requests.\n       *\n       * Whereas the original `express-ws` prefixed this path segment, we suffix it -\n       * this makes it possible to let requests propagate through Routers like normal,\n       * which allows us to specify WebSocket routes on Routers as well \\o/! */\n      var wsRoute = (0, _websocketUrl2.default)(route);\n\n      /* Here we configure our new GET route. It will never get called by a client\n       * directly, it's just to let our request propagate internally, so that we can\n       * leave the regular middleware execution and error handling to Express. */\n      this.get.apply(this, _toConsumableArray([wsRoute].concat(wrappedMiddlewares)));\n\n      /*\n       * Return `this` to allow for chaining:\n       */\n      return this;\n    };\n  }\n}","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = expressWs;\n\nvar _http = require('http');\n\nvar _http2 = _interopRequireDefault(_http);\n\nvar _express = require('express');\n\nvar _express2 = _interopRequireDefault(_express);\n\nvar _ws = require('ws');\n\nvar _ws2 = _interopRequireDefault(_ws);\n\nvar _websocketUrl = require('./websocket-url');\n\nvar _websocketUrl2 = _interopRequireDefault(_websocketUrl);\n\nvar _addWsMethod = require('./add-ws-method');\n\nvar _addWsMethod2 = _interopRequireDefault(_addWsMethod);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction expressWs(app, httpServer) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  var server = httpServer;\n\n  if (server === null || server === undefined) {\n    /* No HTTP server was explicitly provided, create one for our Express application. */\n    server = _http2.default.createServer(app);\n\n    app.listen = function serverListen() {\n      var _server;\n\n      return (_server = server).listen.apply(_server, arguments);\n    };\n  }\n\n  /* Make our custom `.ws` method available directly on the Express application. You should\n   * really be using Routers, though. */\n  (0, _addWsMethod2.default)(app);\n\n  /* Monkeypatch our custom `.ws` method into Express' Router prototype. This makes it possible,\n   * when using the standard Express Router, to use the `.ws` method without any further calls\n   * to `makeRouter`. When using a custom router, the use of `makeRouter` may still be necessary.\n   *\n   * This approach works, because Express does a strange mixin hack - the Router factory\n   * function is simultaneously the prototype that gets assigned to the resulting Router\n   * object. */\n  if (!options.leaveRouterUntouched) {\n    (0, _addWsMethod2.default)(_express2.default.Router);\n  }\n\n  // allow caller to pass in options to WebSocketServer constructor\n  var wsOptions = options.wsOptions || {};\n  wsOptions.server = server;\n  var wsServer = new _ws2.default.Server(wsOptions);\n\n  wsServer.on('connection', function (socket, request) {\n    if ('upgradeReq' in socket) {\n      request = socket.upgradeReq;\n    }\n\n    request.ws = socket;\n    request.wsHandled = false;\n\n    /* By setting this fake `.url` on the request, we ensure that it will end up in the fake\n     * `.get` handler that we defined above - where the wrapper will then unpack the `.ws`\n     * property, indicate that the WebSocket has been handled, and call the actual handler. */\n    request.url = (0, _websocketUrl2.default)(request.url);\n\n    var dummyResponse = new _http2.default.ServerResponse(request);\n\n    dummyResponse.writeHead = function writeHead(statusCode) {\n      if (statusCode > 200) {\n        /* Something in the middleware chain signalled an error. */\n        dummyResponse._header = '';\n        socket.close();\n      }\n    };\n\n    app.handle(request, dummyResponse, function () {\n      if (!request.wsHandled) {\n        /* There was no matching WebSocket-specific route for this request. We'll close\n         * the connection, as no endpoint was able to handle the request anyway... */\n        socket.close();\n      }\n    });\n  });\n\n  return {\n    app: app,\n    getWss: function getWss() {\n      return wsServer;\n    },\n    applyTo: function applyTo(router) {\n      (0, _addWsMethod2.default)(router);\n    }\n  };\n} /* This module does a lot of monkeypatching, but unfortunately that appears to be the only way to\n   * accomplish this kind of stuff in Express.\n   *\n   * Here be dragons. */","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = addTrailingSlash;\nfunction addTrailingSlash(string) {\n  var suffixed = string;\n  if (suffixed.charAt(suffixed.length - 1) !== '/') {\n    suffixed = suffixed + '/';\n  }\n  return suffixed;\n}","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nexports.default = websocketUrl;\n\nvar _trailingSlash = require('./trailing-slash');\n\nvar _trailingSlash2 = _interopRequireDefault(_trailingSlash);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/* The following fixes HenningM/express-ws#17, correctly. */\nfunction websocketUrl(url) {\n  if (url.indexOf('?') !== -1) {\n    var _url$split = url.split('?'),\n        _url$split2 = _slicedToArray(_url$split, 2),\n        baseUrl = _url$split2[0],\n        query = _url$split2[1];\n\n    return (0, _trailingSlash2.default)(baseUrl) + '.websocket?' + query;\n  }\n  return (0, _trailingSlash2.default)(url) + '.websocket';\n}","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = wrapMiddleware;\nfunction wrapMiddleware(middleware) {\n  return function (req, res, next) {\n    if (req.ws !== null && req.ws !== undefined) {\n      req.wsHandled = true;\n      try {\n        /* Unpack the `.ws` property and call the actual handler. */\n        middleware(req.ws, req, next);\n      } catch (err) {\n        /* If an error is thrown, let's send that on to any error handling */\n        next(err);\n      }\n    } else {\n      /* This wasn't a WebSocket request, so skip this middleware. */\n      next();\n    }\n  };\n}","'use strict';\n\nmodule.exports = function () {\n  throw new Error(\n    'ws does not work in the browser. Browser clients must use the native ' +\n      'WebSocket object'\n  );\n};\n"],"names":["module","exports","Object","defineProperty","value","addWsMethod","_wrapMiddleware","_wrapMiddleware2","_interopRequireDefault","_websocketUrl","_websocketUrl2","obj","__esModule","default","_toConsumableArray","arr","Array","isArray","i","arr2","length","from","target","ws","undefined","addWsRoute","route","_len","arguments","middlewares","_key","wrappedMiddlewares","map","wsRoute","this","get","apply","concat","expressWs","_http","_http2","_express","_express2","_ws","_ws2","_addWsMethod","_addWsMethod2","app","httpServer","options","server","createServer","listen","serverListen","_server","leaveRouterUntouched","Router","wsOptions","wsServer","Server","on","socket","request","upgradeReq","wsHandled","url","dummyResponse","ServerResponse","writeHead","statusCode","_header","close","handle","getWss","applyTo","router","addTrailingSlash","string","suffixed","charAt","_slicedToArray","sliceIterator","_arr","_n","_d","_e","_i","Symbol","iterator","_s","next","done","push","err","TypeError","websocketUrl","_trailingSlash","_trailingSlash2","indexOf","_url$split","split","_url$split2","baseUrl","query","wrapMiddleware","middleware","req","res","Error"],"sourceRoot":""}